<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Database on Funky Si's Blog</title><link>https://www.funkysi1701.com/tags/database/</link><description>Recent content in Database on Funky Si's Blog</description><generator>Hugo -- gohugo.io</generator><language>en-gb</language><lastBuildDate>Mon, 06 Nov 2017 20:00:45 +0000</lastBuildDate><atom:link href="https://www.funkysi1701.com/tags/database/index.xml" rel="self" type="application/rss+xml"/><item><title>SQL with Visual Studio Code</title><link>https://www.funkysi1701.com/posts/sql-with-visual-studio-code-1k3psql-with-visual-studio-code/</link><pubDate>Mon, 06 Nov 2017 20:00:45 +0000</pubDate><guid>https://www.funkysi1701.com/posts/sql-with-visual-studio-code-1k3psql-with-visual-studio-code/</guid><description>&lt;p>Writing SQL queries is typically done with SQL Management Studio (SSMS). However this tool is a bit of a beast so let’s look at how you could use Visual Studio Code instead.&lt;/p>
&lt;p>Visual Studio Code is a free text editor but it is so much more than just a text editor. VS Code can be downloaded from &lt;a href="https://code.visualstudio.com/Download" target="_blank" rel="noopener noreferrer">https://code.visualstudio.com/Download&lt;/a>
&lt;/p>
&lt;p>To work with SQL Server download the mssql extension. Press &lt;strong>CTRL+SHIFT+P&lt;/strong> and then Select &lt;strong>Install Extension&lt;/strong> and type &lt;strong>mssql&lt;/strong>.&lt;/p>
&lt;p>Intellisense in Visual Studio Code is brilliant, better than SSMS. Lets look at how to get it all set up.&lt;/p>
&lt;p>Create a new file and set the language type to SQL (Press &lt;strong>CTRL+K,M&lt;/strong> )&lt;/p>
&lt;p>Open the command palette, &lt;strong>CTRL+SHIFT+P&lt;/strong> and type SQL to show the mssql commands. Select the Connect command.&lt;/p>
&lt;p>Then select &lt;strong>Create Connection Profile&lt;/strong> , this creates a profile to connect with your SQL Server. Follow the prompts to get it all setup.&lt;/p>
&lt;p>Look in the bottom right corner of the status bar and you should see you are connected.&lt;/p>
&lt;p>Now if you type sql you will see a long list of SQL code snippets that you could use.&lt;/p>
&lt;p>&lt;img class="img-fluid" alt="" src="https://storageaccountblog9f5d.blob.core.windows.net/blazor/wp-content/uploads/2017/11/vscode-sql-snippets.png?resize=662%2C348&amp;amp;ssl=1" loading="lazy"
/>
&lt;/p>
&lt;p>Choose a snippet to create, and edit it as required. When you are happy press **CTRL+SHIFT+E ** to execute.&lt;/p>
&lt;p>This is basically all there is to it. However this is an incredibly powerful way of working, the intellisense instantly tells you what database objects you can use in your query and there is a wealth of different snippets you can use.&lt;/p>
&lt;p>When returning data you get a similar view to SSMS but you can save as Excel, CSV or JSON.&lt;/p>
&lt;p>SSMS is a very graphical way of doing things, you can double click a table and see its columns or indexes. VS Code relies on TSQL commands but you have access to exactly the same information.&lt;/p>
&lt;p>For more information about VS Code and the mssql extension check out &lt;a href="https://docs.microsoft.com/en-us/sql/linux/sql-server-linux-develop-use-vscode" target="_blank" rel="noopener noreferrer">https://docs.microsoft.com/en-us/sql/linux/sql-server-linux-develop-use-vscode&lt;/a>
&lt;/p></description></item><item><title>SQL Server Management Studio</title><link>https://www.funkysi1701.com/posts/sql-server-management-studio/</link><pubDate>Thu, 03 Dec 2015 00:00:00 +0000</pubDate><guid>https://www.funkysi1701.com/posts/sql-server-management-studio/</guid><description>&lt;p>I use SQL Server Management Studio all the time for writing queries, getting data and general SQL development.&lt;/p>
&lt;p>&lt;img class="img-fluid" alt="SQL Server Management Studio" src="https://storageaccountblog9f5d.blob.core.windows.net/blazor/wp-content/uploads/2015/12/sql-server-2012-management-studio-splash-screen.png?resize=529%2C360" loading="lazy"
/>
&lt;/p>
&lt;p>I have enjoyed seeing the improvements that each new version of SQL Server Management Studio (SSMS) introduced. One great improvement was intellisense.&lt;/p>
&lt;p>This feature saves typing and reduces errors by automatically suggesting tables, column names or other database objects.&lt;/p>
&lt;p>A common query that I get asked to write is provide a spreadsheet that gives the information that satisfies certain criteria. This is easy to do in SSMS, you can write the query, click execute and the rows that satisfy the criteria are displayed. These rows can then be easily copy/pasted into Excel or other spreadsheets.&lt;/p>
&lt;p>A common data item that gets stored in databases is addresses and addresses often contain line breaks to make the data display better. In the earlier versions of SSMS, when you copied and pasted these line breaks were ignored and the data displayed the same in SSMS as it did in Excel. However in the more recent version, theses line breaks got copied across breaking your spreadsheet and making it hard to see what data corresponded with what.&lt;/p>
&lt;p>Now I don’t know if this should be described as introducing a bug or fixing one. I can easily argue both sides. If your data contains a line break and you copy this data it should include the line break in the destination, but if it does that it displays badly in Excel.&lt;/p>
&lt;p>The fix I have been using until recently is to use the following TSQL command in my queries.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-sql" data-lang="sql">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">SELECT&lt;/span> &lt;span style="color:#66d9ef">REPLACE&lt;/span>(&lt;span style="color:#66d9ef">REPLACE&lt;/span>(&lt;span style="color:#f92672">@&lt;/span>str, CHAR(&lt;span style="color:#ae81ff">13&lt;/span>), &lt;span style="color:#e6db74">&amp;#34;), CHAR(10), &amp;#34;&lt;/span>)
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>This command replaces any line breaks with an empty string. Both Char(10) and Char(13) are needed because you can have different types of line breaks. This is great if you are writing the script from scratch but isn’t great if your are running a stored procedure or your query has a lot of columns.&lt;/p>
&lt;p>The answer to this is to use Visual Studio to run your SQL query. In Visual Studio you can write and run queries via Server Explorer and the results produced don’t contain line breaks. I have only just discovered this solution, but so far it has worked and is very easy to do, plus as I do most of my development in Visual Studio anyway it saves me having to open SSMS to test my queries.&lt;/p></description></item></channel></rss>