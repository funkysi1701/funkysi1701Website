<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Source Control on Funky Si's Blog</title><link>https://www.funkysi1701.com/tags/source-control/</link><description>Recent content in Source Control on Funky Si's Blog</description><generator>Hugo -- gohugo.io</generator><language>en-gb</language><lastBuildDate>Thu, 07 Jul 2016 20:00:45 +0000</lastBuildDate><atom:link href="https://www.funkysi1701.com/tags/source-control/index.xml" rel="self" type="application/rss+xml"/><item><title>Clever things with MS Access</title><link>https://www.funkysi1701.com/posts/2016/clever-things-ms-access/</link><pubDate>Thu, 07 Jul 2016 20:00:45 +0000</pubDate><guid>https://www.funkysi1701.com/posts/2016/clever-things-ms-access/</guid><description>&lt;p>I hate MS Access and especially developing with it as you can’t do any thing clever with it.&lt;/p>
&lt;p>&lt;strong>Wrong, Wrong, Wrong!&lt;/strong>&lt;/p>
&lt;p>There are a few clever things I have been able to script to make developing with it passable. I still would rather use Visual Studio but this improves the experience a fair bit.&lt;/p>
&lt;h2 id="source-control">Source Control&lt;a class="anchor ms-1" href="#source-control">&lt;i class="fas fa-link">&lt;/i>&lt;/a>&lt;/h2>
&lt;p>Access files are binary (I use the ADP/ADE file format but I assume other Access file formats have the same problem) and so you can’t diff them to see what has changed. This is bad.&lt;/p>
&lt;p>However there is a solution to this. A tool called Access SVN and can be downloaded from &lt;a href="https://accesssvn.codeplex.com/" target="_blank" rel="noopener noreferrer">https://accesssvn.codeplex.com/&lt;/a>
, this gives you a way to extract to text files all the forms and reports that are in Access. Before every commit I would manually run this tool on my ADP file and extract to text files, then I would commit these text files to source control and could easily see what had changed in each commit.&lt;/p>
&lt;p>Despite the name Access SVN, the tool is not tied to subversion, you can use any source control system, I use git.&lt;/p>
&lt;p>Also included in this tool is a way to do this with the command line, so you can make this a build step on your build server. I have not used this extensively yet, but the syntax is fairly simple&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>asvn.exe e &lt;span style="color:#e6db74">&amp;#34;path to Access file&amp;#34;&lt;/span> &lt;span style="color:#e6db74">&amp;#34;path to txt files&amp;#34;&lt;/span> &lt;span style="color:#e6db74">&amp;#34;*.*&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>The filter at the end &lt;em>.&lt;/em> allows you to specify what to extract so you could extract all forms/reports beginning with D with &amp;ldquo;&lt;em>.D&lt;/em>&amp;rdquo;. I had trouble using &lt;em>.&lt;/em> because the names of my forms/reports contain characters not allowed in a windows file name. I am sure there is a way round this but I haven’t had chance to look into it further yet.&lt;/p>
&lt;h2 id="testing-ms-access">Testing MS Access&lt;a class="anchor ms-1" href="#testing-ms-access">&lt;i class="fas fa-link">&lt;/i>&lt;/a>&lt;/h2>
&lt;p>Surely testing is not possible with MS Access? I would have agreed with that statement the other day until I found a neat way of testing if a feature is enabled.&lt;/p>
&lt;p>Firstly a bit of background. I develop using MS Access 2003 because the design view is far easier to use, however because it is out of support all my users use MS Access 2010. MS Access 2010 has a feature called Tabbed Documents which allows all forms and reports to open in new tabs so you can easily switch between them. This feature can only be enabled in MS Access 2010 and has no effect if opening with MS Access 2003.&lt;/p>
&lt;p>If you use Access SVN on your Access file with tabbed documents turned on and off you will see UseMDIMode: 0 and UseMDIMode: 1 show up in the Database properties file. UseMDIMode: 0 means that tabbed documents is turned on.&lt;/p>
&lt;p>In powershell I can now write a test to see if UseMDIMode: 0 can be found in the database properties file&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-powershell" data-lang="powershell">&lt;span style="display:flex;">&lt;span>Get-Content &lt;span style="color:#e6db74">&amp;#34;General\Database properties.dbp.txt&amp;#34;&lt;/span> | Select-String &lt;span style="color:#e6db74">&amp;#34;UseMDIMode: 0&amp;#34;&lt;/span> -quiet
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>If the test passes True will be returned, if it fails null will be returned.&lt;/p>
&lt;p>On my build server I scripted the extraction of Database properties.dbp.txt from the ADP file with asvn.exe before running this test. While not strictly needed as Database properties.dbp.txt should be in source control, it is possible that someone could forget to extract the text files from the ADP, with this step you are always testing what is enabled in the binary file.&lt;/p>
&lt;h2 id="ms-access-connection-strings">MS Access Connection Strings&lt;a class="anchor ms-1" href="#ms-access-connection-strings">&lt;i class="fas fa-link">&lt;/i>&lt;/a>&lt;/h2>
&lt;p>While developing with MS Access I often swap the database connection to point to my local machine or a build server. I always try and remember to only ever commit with this set to the live database to avoid obvious problems.&lt;/p>
&lt;p>The other day I found on &lt;a href="https://stackoverflow.com/questions/16411430/change-access-server-connection-from-command-line" target="_blank" rel="noopener noreferrer">stackoverflow&lt;/a>
a way to script this. I love this! I can include this step in my deployment process and it will overwrite what ever the connection string is in source control with what your production environment needs.&lt;/p>
&lt;p>All you need to run this step is, (note it is spaces between the parameters not commas)&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>cscript connect.vbs Project.adp &lt;span style="color:#e6db74">&amp;#34;ServerName&amp;#34;&lt;/span> &lt;span style="color:#e6db74">&amp;#34;DatabaseName&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>The contents of connect.vbs can be found on the &lt;a href="https://stackoverflow.com/questions/16411430/change-access-server-connection-from-command-line" target="_blank" rel="noopener noreferrer">stackoverflow article&lt;/a>
. It is also possible to pass username and password if your environment requires this.&lt;/p>
&lt;h2 id="compiled-ade">Compiled ADE&lt;a class="anchor ms-1" href="#compiled-ade">&lt;i class="fas fa-link">&lt;/i>&lt;/a>&lt;/h2>
&lt;p>The last clever thing I do with MS Access is convert my ADP file into the compiled ADE version. To manually do this there is an option in the tools menu.&lt;/p>
&lt;p>To automate this I run&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>cscript createADE.vbs &lt;span style="color:#e6db74">&amp;#34;path to ADP&amp;#34;&lt;/span> &lt;span style="color:#e6db74">&amp;#34;path to ADE&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>The contents of createADE came from this &lt;a href="https://social.msdn.microsoft.com/Forums/office/en-US/01fd48a9-258e-4405-86f1-adfb2f1057ee/create-an-access-2007-ade-from-a-adp-via-commandline?forum=accessdev" target="_blank" rel="noopener noreferrer">forum post&lt;/a>
, the only change I made was to comment out some of the echo statements so it would run silently as part of my build process. It should be noted that cscript and wscript are almost identical and either will run these scripts however in a command line environment cscript is preferable, and wscript should be used in a windows environment.&lt;/p>
&lt;p>I am quite surprised at how much I have managed to do in terms of scripting the build and deployment process for MS Access. I still don’t like developing with Access but this has definitely improved things.&lt;/p></description></item><item><title>Automatic Git Tagging</title><link>https://www.funkysi1701.com/posts/2016/automatic-git-tagging/</link><pubDate>Thu, 16 Jun 2016 20:00:45 +0000</pubDate><guid>https://www.funkysi1701.com/posts/2016/automatic-git-tagging/</guid><description>&lt;p>One of the features of git is the ability to tag a point in my change history with a tag. For a while now I have been manually tagging my code whenever I do a release, so I can easily work out what has changed by doing a diff between two tags.&lt;/p>
&lt;p>Now that I am automating my release process with TeamCity I am thinking about how to manage my tags better.&lt;/p>
&lt;p>TeamCity has a setting called VCS Labeling which comes in very handy.
&lt;img class="img-fluid" alt="" src="https://storageaccountblog9f5d.blob.core.windows.net/blazor/wp-content/uploads/2016/06/Untitled.jpg?w=1595&amp;amp;ssl=1" loading="lazy"
/>
&lt;/p>
&lt;p>Configuring it is fairly simple as it only has three settings.&lt;/p>
&lt;p>&lt;strong>VCS root to label&lt;/strong>: This is obviously the url to your git repository
&lt;strong>Labeling pattern&lt;/strong>: This is the text of the label to be added.
&lt;strong>Label successful builds only&lt;/strong>: Do you really want to add a tag if the build failed?&lt;/p>
&lt;p>A tag needs to have a unique name, so adding a tag just called &lt;strong>deployed&lt;/strong> won’t work. When I used to add tags manually I used the naming convention of &lt;strong>deployedyyyymmdd&lt;/strong>. While this naming convention is possible with TeamCity I use something a bit more complex to provide more information about what has been deployed.&lt;/p>
&lt;p>TeamCity provides lots of parameters that can be used in your build steps and also in the Labeling pattern box. I started off using &lt;strong>deployed-build-%system.build.number%&lt;/strong> as my tag which just marks git with the TeamCity build number.&lt;/p>
&lt;p>When I run a TeamCity deployment I don’t always use the same configuration options, I deploy locally, to a test server or to production and sometimes I just deploy the frontend or the backend. How cool would it be to include this information in the tag text?&lt;/p>
&lt;p>Well the next step was to change my Labeling pattern to &lt;strong>deployed-build-%system.build.number%-%ServerName%-%DatabaseName%-%FrontEndPath%&lt;/strong>, this adds the backend database config settings and the path the frontend was deployed to. Now when looking at git you can see commits marked with multiple tags, one for each deployment that succeeded and the tag will indicate the settings used during that deployment.&lt;/p>
&lt;p>Now I will never forget to add the tag after a release as the adding of a tag is part of the deployment process, if the deployment fails the tag won’t be added. I can test my deployment to test and git will show if this has been successful, and when I deploy live this will also show up.&lt;/p>
&lt;p>How do you use tags? Do you mark successful builds with a tag? Why not let me know or leave a comment below.&lt;/p></description></item><item><title>Revisiting Team City</title><link>https://www.funkysi1701.com/posts/2016/revisiting-teamcity/</link><pubDate>Thu, 24 Mar 2016 20:00:45 +0000</pubDate><guid>https://www.funkysi1701.com/posts/2016/revisiting-teamcity/</guid><description>&lt;p>Last year I blogged about &lt;a href="http://www.funkysi1701.com/2015/04/01/teamcity/">Team City&lt;/a>
, well I have been looking at it again recently. In that time they have even changed their logo!&lt;/p>
&lt;p>Lets start with thinking about what I want my Continuous Integration server to do.&lt;/p>
&lt;ol>
&lt;li>Check out my code from source control (usually master but all feature branches would be even better)&lt;/li>
&lt;li>Configure specific setting for build&lt;/li>
&lt;li>Build my code&lt;/li>
&lt;li>Build my databases&lt;/li>
&lt;li>Run any unit tests&lt;/li>
&lt;li>(Optional) Run deployment to Azure Test/Live site&lt;/li>
&lt;/ol>
&lt;p>There are probably other things I want to achieve but I will start with these six.&lt;/p>
&lt;ol>
&lt;li>Checking out code from source control is something Team City does out of the box, so I can safely say I have done this now. It even monitors a branch for changes and initiates a new check out.&lt;/li>
&lt;li>Team City allows you to create specific build steps so in theory you can have multiple builds for every variation of settings that you want for your code. I have not tried this yet apart from building with the default config, but I don’t expect it will be too difficult.&lt;/li>
&lt;li>I have managed to get my code to build with Team City, it took a bit of tweaking the different build steps but wasn’t too difficult. Team City has a visual studio build agent which takes you solution file and does what it needs to. The one problem I have found with this step is that I get errors with my tests if I select a Debug config instead of Release.&lt;/li>
&lt;li>Databases are always the problem part of the deployment. So far I have manually deployed my databases but I intend on revisit this step. A &lt;a href="https://stackoverflow.com/questions/21555038/how-can-i-execute-sql-scripts-using-teamcity" target="_blank" rel="noopener noreferrer">stackoverflow&lt;/a>
post suggests that I can run SQL code via Team City in the following way by creating a command line executable:&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>Command executable: c:&lt;span style="color:#ae81ff">\P&lt;/span>rogram Files&lt;span style="color:#ae81ff">\M&lt;/span>icrosoft SQL Server&lt;span style="color:#ae81ff">\1&lt;/span>00&lt;span style="color:#ae81ff">\T&lt;/span>ools&lt;span style="color:#ae81ff">\B&lt;/span>inn&lt;span style="color:#ae81ff">\s&lt;/span>qlcmd.exe
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Command parameters: -S &lt;span style="color:#f92672">[&lt;/span>ServerName&lt;span style="color:#f92672">]&lt;/span> -i &lt;span style="color:#f92672">[&lt;/span>PathToSQLScript&lt;span style="color:#f92672">]&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>I have yet to try this but I am hopefully that it will just work. Dropping a database and restoring a back and then running different SQL scripts is all possible from TSQL, so I should be OK. Watch this space for more details.&lt;/p>
&lt;ol start="5">
&lt;li>Running the unit tests got me stuck for a while. I tried setting it up using VSTest or MSTest neither worked mainly because a config file wasn’t being copied with the test binaries. When I tried using NUnit it just worked. The tests that failed gave me a few config settings to change.&lt;/li>
&lt;li>I have powershell scripts that deploy to Azure websites, I think that these could form the basis of a deployment to Azure. Again the difficult step here may end up being deploying all the different databases to Azure. This is also the riskiest step as I need to connect to live servers which is why I will leave this to last, at the very least I could generate scripts that do a full deployment.&lt;/li>
&lt;/ol>
&lt;p>That’s it for now. Once I have this all working I will revisit again with details of the database steps as I am expecting a few challenges to overcome. What have you used a CI Server for? Are there other things I want to achieve from a project like this? Why not contact me or leave a comment below&lt;/p></description></item></channel></rss>